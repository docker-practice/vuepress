(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{602:function(s,a,n){"use strict";n.r(a);var t=n(1),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"外部访问容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#外部访问容器"}},[s._v("#")]),s._v(" 外部访问容器")]),s._v(" "),n("AdSenseTitle"),s._v(" "),n("p",[s._v("容器中可以运行一些网络应用，要让外部也可以访问这些应用，可以通过 "),n("code",[s._v("-P")]),s._v(" 或 "),n("code",[s._v("-p")]),s._v(" 参数来指定端口映射。")]),s._v(" "),n("p",[s._v("当使用 "),n("code",[s._v("-P")]),s._v(" 标记时，Docker 会随机映射一个端口到内部容器开放的网络端口。")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("docker container ls")]),s._v(" 可以看到，本地主机的 32768 被映射到了容器的 80 端口。此时访问本机的 32768 端口即可访问容器内 NGINX 默认页面。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P nginx:alpine\n\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                   NAMES\nfae320d08268        nginx:alpine        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" seconds ago      Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" seconds       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32768-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   bold_mcnulty\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("同样的，可以通过 "),n("code",[s._v("docker logs")]),s._v(" 命令来查看访问记录。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs fa\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.1 - - "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("/Aug/2020:08:34:04 +0000"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET / HTTP/1.1"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("612")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("code",[s._v("-p")]),s._v(" 则可以指定要映射的端口，并且，在一个指定端口上只可以绑定一个容器。支持的格式有 "),n("code",[s._v("ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort")]),s._v("。")]),s._v(" "),n("h2",{attrs:{id:"映射所有接口地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#映射所有接口地址"}},[s._v("#")]),s._v(" 映射所有接口地址")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("hostPort:containerPort")]),s._v(" 格式本地的 80 端口映射到容器的 80 端口，可以执行")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 nginx:alpine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("此时默认会绑定本地所有接口上的所有地址。")]),s._v(" "),n("h2",{attrs:{id:"映射到指定地址的指定端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#映射到指定地址的指定端口"}},[s._v("#")]),s._v(" 映射到指定地址的指定端口")]),s._v(" "),n("p",[s._v("可以使用 "),n("code",[s._v("ip:hostPort:containerPort")]),s._v(" 格式指定映射使用一个特定地址，比如 localhost 地址 127.0.0.1")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:80:80 nginx:alpine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"映射到指定地址的任意端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#映射到指定地址的任意端口"}},[s._v("#")]),s._v(" 映射到指定地址的任意端口")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("ip::containerPort")]),s._v(" 绑定 localhost 的任意端口到容器的 80 端口，本地主机会自动分配一个端口。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1::80 nginx:alpine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("还可以使用 "),n("code",[s._v("udp")]),s._v(" 标记来指定 "),n("code",[s._v("udp")]),s._v(" 端口")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:80:80/udp nginx:alpine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"查看映射端口配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看映射端口配置"}},[s._v("#")]),s._v(" 查看映射端口配置")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("docker port")]),s._v(" 来查看当前映射的端口配置，也可以查看到绑定的地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" port fa "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32768\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("注意：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("容器有自己的内部网络和 ip 地址（使用 "),n("code",[s._v("docker inspect")]),s._v(" 查看，Docker 还可以有一个可变的网络配置。）")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("-p")]),s._v(" 标记可以多次使用来绑定多个端口")])])]),s._v(" "),n("p",[s._v("例如")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(":443 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    nginx:alpine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);